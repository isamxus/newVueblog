webpackJsonp([3],{g99M:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("aA9S"),o=a.n(n),r=a("rVsN"),l=a.n(r),i={paramsDetailGetList:function(e){return axios.post(REQUEST_URL.paramsDetailGetList,REQUEST_URL.handleParams(e)).then(function(e){return l.a.resolve(e.data.PostContent)})},articleGetList:function(e){return axios.post(REQUEST_URL.articleGetList,REQUEST_URL.handleParams(e)).then(function(e){return l.a.resolve(e.data.PostContent)})},IndexImageGetList:function(e){return axios.post(REQUEST_URL.IndexImageGetList,REQUEST_URL.handleParams(e)).then(function(e){return l.a.resolve(e.data.PostContent)})},IndexImageCreate:function(e){return axios.post(REQUEST_URL.IndexImageCreate,REQUEST_URL.handleParams(e)).then(function(e){return l.a.resolve(e.data.PostContent)})},IndexImageUpdate:function(e){return axios.post(REQUEST_URL.IndexImageUpdate,REQUEST_URL.handleParams(e)).then(function(e){return l.a.resolve(e.data.PostContent)})},IndexImageDelete:function(e){return axios.post(REQUEST_URL.IndexImageDelete,REQUEST_URL.handleParams(e)).then(function(e){return l.a.resolve(e.data.PostContent)})}},s=function(e){return o()({uploadStatus:null,IndexImageName:"",IndexImageUrl:"",uploadList:[],ConnectArticleID:"",ConnectArticleName:"",ConnectArticleCateID:"",ConnectArticleCateName:"",ShowOnIndex:!1,edit:!1},e)},d={data:function(){return{breadcrumbs:[{title:this.$route.query.paramsName}],columns:[{title:"序号",type:"index",width:120},{title:"关联文章",key:"ConnectArticleName"},{title:"首页显示",render:this.ShowOnIndexRender},{title:"操作",align:"center",render:this.toolColumnRender}],tableList:[],uploadUrl:REQUEST_URL.IndexImageUpload,popModal:!1,createModal:s(),createModalRules:{ConnectArticleID:[{required:!0,message:"请选择关联文章"}]},articleListData:[],selectData:[]}},components:{SubNavigationFrame:a("C7Kb").a},mounted:function(){this.$store.commit("showAdminMenu",!0),this.getCategoryHandler(),this.getImageListHandler()},methods:{ShowOnIndexRender:function(e,t){return e("span",{domProps:{innerText:t.row.ShowOnIndex?"是":"否"}})},toolColumnRender:function(e,t){var a=this;return e("div",[e("Button",{props:{type:"text"},domProps:{innerText:"编辑"},on:{click:function(e){e.stopPropagation(),a.createModal=t.row,a.selectData=[a.createModal.ConnectArticleCateID,a.createModal.ConnectArticleID],a.popModal=!0,t.row.edit=!0}}}),e("Button",{props:{type:"text"},domProps:{innerText:"删除"},on:{click:function(e){if(e.stopPropagation(),!t.row.IndexImageID)return a.$Message.warning("参数ID为空，无法删除！！！");a.$Modal.confirm({title:"操作确认",icon:"warning",content:"是否删除此轮播图",okText:"确定",showCancel:!0,loading:!0,onOk:function(){i.IndexImageDelete({PostContent:{IndexImageID:t.row.IndexImageID}}).then(function(e){a.$Message.success("成功删除轮播图！！！"),a.$Modal.remove(),a.getImageListHandler()}).catch(function(e){a.$Modal.remove(),a.$Message.error(e)})}})}}})])},resetFormHandler:function(){this.createModal=s(),this.popModal=!0},handleBeforeUploadNum:function(e,t){return e?e.$props.maxSize&&t.size/1024>e.$props.maxSize?(this.handleError({Msg:"文件体积过大，无法上传",State:-1},t,this.createModal.uploadList),!1):(this.createModal.uploadStatus=this.$Message.loading({content:"正在上传文档，请稍等...",duration:0}),void(this.createModal.uploadList.length&&this.$refs.uploadFileRef.clearFiles())):(this.handleError({Msg:"无法获取上传组件",State:-1},t,this.createModal.uploadList),!1)},handleSuccess:function(e,t,a){if(1!=e.State)return this.handleError(e,t,a),a.splice(a.length-1,1);if(console.log(t),this.createModal.uploadStatus(),this.createModal.uploadStatus=null,1!=e.State)return this.handleError(e,t,a),a.splice(a.length-1,1);var n=this.createModal;n.IndexImageName=t.name,n.IndexImageUrl=t.response.PostContent.Address},handleFormatError:function(e,t){this.createModal.uploadStatus(),this.createModal.uploadStatus=null,this.$Message.warning("文件格式错误，请重新上传")},handleError:function(e,t,a){this.createModal.uploadStatus(),this.createModal.uploadStatus=null,this.$Message.warning(e&&e.Msg||"文件上传失败")},handleMaxSize:function(e){this.createModal.uploadStatus(),this.createModal.uploadStatus=null,this.$Message.warning("超出文件大小限制，文档不能超过 15M")},openUrlHandler:function(e,t){var a=""+REQUEST_URL.IndexImageDownload+e;window.open(a)},getCategoryHandler:function(){var e=this;i.paramsDetailGetList({PostContent:{filter:{detailParentParamCode:"0001"}}}).then(function(t){e.articleListData=t.map(function(e){return{value:e.detail_params_id,label:e.detailName,children:[],loading:!1}})}).catch(function(t){e.$Message.error(t)})},loadArticleData:function(e,t){var a=this;e.loading=!0,i.articleGetList({PostContent:{filter:{articleCagetoryID:e.value}}}).then(function(a){e.children=a.map(function(e){return{value:e.article_id,label:e.articleTitle,parentName:e.articleCagetoryName,parentID:e.articleCagetoryID}}),e.loading=!1,t()}).catch(function(e){a.$Message.error(e)})},articleSelectHandler:function(e,t){if(0!=t.length){var a=t[t.length-1];this.createModal.ConnectArticleCateID=a.parentID,this.createModal.ConnectArticleCateName=a.parentName,this.createModal.ConnectArticleID=a.value,this.createModal.ConnectArticleName=a.label}},getImageListHandler:function(){var e=this;i.IndexImageGetList().then(function(t){e.tableList=t}).catch(function(t){e.$Message.error(t)})},submitDataHandler:function(){var e=this;return this.createModal.IndexImageName?this.createModal.ConnectArticleID?void i[this.createModal.edit?"IndexImageUpdate":"IndexImageCreate"]({PostContent:this.createModal}).then(function(t){e.popModal=!1,e.getImageListHandler()}).catch(function(t){e.$Message.error(t)}):this.$Message.warning("请选择关联文章"):this.$Message.warning("请上传图片")}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("SubNavigationFrame",{attrs:{title:e.$route.query.paramsName,breadcrumb:e.breadcrumbs}},[a("div",{style:{textAlign:"right",marginTop:"-2.5rem"},attrs:{slot:"navigation"},slot:"navigation"},[a("Button",{on:{click:function(t){return e.$router.push({name:"Index"})}}},[e._v("返回主站")]),e._v(" "),a("Button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")])],1),e._v(" "),a("div",{staticClass:"sub-page-container",style:{"margin-top":".5rem","padding-top":"1rem"},attrs:{slot:"content"},slot:"content"},[a("Row",[a("Col",{attrs:{span:"8"}},[a("div",{style:{marginBottom:".7rem"}},[a("Button",{attrs:{type:"primary"},on:{click:e.resetFormHandler}},[a("Icon",{attrs:{type:"md-add"}}),e._v("新增轮播图")],1)],1)])],1),e._v(" "),a("div",{style:{overflow:"auto"}},[a("Table",{style:{minWidth:"1040px"},attrs:{columns:e.columns,data:e.tableList}})],1),e._v(" "),a("Modal",{attrs:{title:e.createModal.edit?"编辑":"新增",width:"600"},model:{value:e.popModal,callback:function(t){e.popModal=t},expression:"popModal"}},[a("Form",{ref:"createForm",staticStyle:{"padding-right":"2rem"},attrs:{"label-width":100,model:e.createModal,rules:e.createModalRules}},[a("FormItem",{attrs:{label:"轮播图片：",prop:"ContractTemplateName"}},[a("Upload",{ref:"uploadFileRef",style:{display:"inline-block"},attrs:{action:e.uploadUrl,format:["jpg","png","jpeg"],"max-size":1e5,"before-upload":function(t){return e.handleBeforeUploadNum(e.$refs.uploadFileRef,t)},"on-success":e.handleSuccess,"on-format-error":e.handleFormatError,"on-error":e.handleError,"on-exceeded-size":e.handleMaxSize,"show-upload-list":!1}},[a("Button",[e._v("上传图片")])],1),e._v(" "),a("p",[e._v("说明：请上传jpg,jpeg,png格式的图片")]),e._v(" "),e.createModal.IndexImageUrl?a("div",[a("div",{staticStyle:{"font-size":".7rem","word-break":"break-all",cursor:"pointer"},on:{click:function(t){return e.openUrlHandler(e.createModal.IndexImageUrl,e.createModal.IndexImageName)}}},[a("Icon",{attrs:{type:"ios-link"}}),e._v(" "),a("span",{style:{color:"#2d8cf0",paddingRight:".2rem"}},[e._v("\n                              "+e._s(e.createModal.IndexImageName)+"\n                          ")])],1)]):e._e()],1),e._v(" "),a("FormItem",{staticClass:"sub-page-input-container min-input-container",attrs:{label:"关联文章：",prop:"ConnectArticleID"}},[a("Cascader",{attrs:{data:e.articleListData,"load-data":e.loadArticleData},on:{"on-change":e.articleSelectHandler},model:{value:e.selectData,callback:function(t){e.selectData=t},expression:"selectData"}})],1),e._v(" "),a("FormItem",{attrs:{label:"是否显示：",prop:"ShowOnIndex"}},[a("i-switch",{model:{value:e.createModal.ShowOnIndex,callback:function(t){e.$set(e.createModal,"ShowOnIndex",t)},expression:"createModal.ShowOnIndex"}},[a("span",{attrs:{slot:"open"},slot:"open"},[e._v("是")]),e._v(" "),a("span",{attrs:{slot:"close"},slot:"close"},[e._v("否")])])],1)],1),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:e.submitDataHandler}},[e._v("确定")]),e._v(" "),a("Button",{on:{click:function(t){e.popModal=!1}}},[e._v("取消")])],1)],1)],1)])},staticRenderFns:[]};var u=a("C7Lr")(d,c,!1,function(e){a("gVjl")},null,null);t.default=u.exports},gVjl:function(e,t){}});
//# sourceMappingURL=3.e049f22d106caa4d1f8a.js.map